<div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <div class="admin-info">
                <h1 class="admin-title">🎯 لوحة إدارة اجتماع أولياء الأمور</h1>
                <p class="admin-subtitle">متوسطة المنذر بن عمرو الأنصاري - مكتب تعليم العوالي</p>
                <div class="admin-name">👨‍💼 مدير المدرسة: خالد سعود المطيري</div>
                <div class="current-date" id="currentDate">📅 اليوم: الخميس 28 أغسطس 2025</div>
            </div>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card bookings">
                <div class="stat-icon">👥</div>
                <div class="stat-number" id="totalBookings">0</div>
                <div class="stat-label">إجمالي الحجوزات</div>
                <div class="stat-description">عدد أولياء الأمور المسجلين للحضور</div>
            </div>
            
            <div class="stat-card excuses">
                <div class="stat-icon">😔</div>
                <div class="stat-number" id="totalExcuses">0</div>
                <div class="stat-label">إجمالي الاعتذارات</div>
                <div class="stat-description">عدد أولياء الأمور المعتذرين</div>
            </div>
            
            <div class="stat-card available">
                <div class="stat-icon">⭐</div>
                <div class="stat-number" id="availableSlots">400</div>
                <div class="stat-label">المقاعد المتاحة</div>
                <div class="stat-description">المقاعد المتبقية للحجز</div>
            </div>
            
            <div class="stat-card occupancy">
                <div class="stat-icon">📊</div>
                <div class="stat-number" id="occupancyRate">0%</div>
                <div class="stat-label">نسبة الإشغال</div>
                <div class="stat-description">نسبة المقاعد المحجوزة</div>
            </div>
        </div>
        
        <!-- Quick Stats -->
        <div class="quick-stats">
            <h3 class="quick-stats-title">📈 إحصائيات سريعة</h3>
            <div class="quick-stats-grid">
                <div class="quick-stat-item">
                    <div class="quick-stat-number" id="busyDays">0</div>
                    <div class="quick-stat-label">أيام مشغولة</div>
                </div>
                <div class="quick-stat-item">
                    <div class="quick-stat-number" id="fullDays">0</div>
                    <div class="quick-stat-label">أيام مكتملة</div>
                </div>
                <div class="quick-stat-item">
                    <div class="quick-stat-number" id="avgPerDay">0</div>
                    <div class="quick-stat-label">متوسط يومي</div>
                </div>
                <div class="quick-stat-item">
                    <div class="quick-stat-number" id="responseRate">0%</div>
                    <div class="quick-stat-label">معدل الاستجابة</div>
                </div>
            </div>
        </div>
        
        <!-- Main Content Grid -->
        <div class="main-content">
            <!-- Days Overview -->
            <div class="days-overview">
                <h2 class="overview-title">📅 نظرة عامة على الأيام</h2>
                <div class="days-grid" id="daysGrid">
                    <!-- سيتم إنشاؤها ديناميكياً بواسطة JavaScript -->
                </div>
            </div>
            
            <!-- Control Panel -->
            <div class="controls-panel">
                <h3 class="controls-title">🛠️ أدوات الإدارة</h3>
                <button class="control-btn btn-primary" onclick="showDetailedReport()">
                    📋 تقرير مفصل
                </button>
                <button class="control-btn btn-secondary" onclick="exportToExcel()">
                    📤 تصدير Excel
                </button>
                <button class="control-btn btn-warning" onclick="printReport()">
                    🖨️ طباعة
                </button>
                <button class="control-btn btn-danger" onclick="resetAllData()">
                    🗑️ إعادة تعيين
                </button>
                
                <div class="quick-stats" style="margin-top: 25px; padding: 20px; box-shadow: none; border: 2px solid #f0f0f0;">
                    <h4 style="font-size: 16px; margin-bottom: 15px; color: #0d5c0d;">⚡ تحديث مباشر</h4>
                    <div style="font-size: 14px; color: #666; text-align: center;">
                        <div>آخر تحديث:</div>
                        <div id="lastUpdate" style="color: #0d5c0d; font-weight: 600;">الآن</div>
                    </div>
                </div>
            </div>
        </div>
    </div>        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">👥</div>
                <div class="stat-number" id="totalBookings">0</div>
                <div class="stat-label">إجمالي الحجوزات</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">😔</div>
                <div class="stat-number" id="totalExcuses">0</div>
                <div class="stat-label">إجمالي الاعتذارات</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">⭐</div>
                <div class="stat-number" id="availableSlots">400</div>
                <div class="stat-label">المقاعد المتاحة</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">📊</div>
                <div class="stat-number" id="occupancyRate">0%</div>
                <div class="stat-label">نسب<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة إدارة اجتماع أولياء الأمور - خالد سعود المطيري</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
        }
        
        .dashboard-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #0d5c0d, #1a7a1a);
            color: white;
            padding: 40px 30px;
            border-radius: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            margin-bottom: 30px;
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="15" height="15" patternUnits="userSpaceOnUse"><circle cx="7.5" cy="7.5" r="1" fill="rgba(255,255,255,0.1)"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
        }
        
        .admin-info {
            position: relative;
            z-index: 1;
        }
        
        .admin-title {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .admin-subtitle {
            font-size: 18px;
            opacity: 0.95;
            margin-bottom: 10px;
        }
        
        .admin-name {
            font-size: 20px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 2px solid rgba(255,255,255,0.3);
            font-weight: 600;
        }
        
        .current-date {
            font-size: 16px;
            opacity: 0.9;
            margin-top: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: white;
            padding: 30px 25px;
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            text-align: center;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid #f0f0f0;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--card-color), transparent);
            transition: left 0.6s ease;
        }
        
        .stat-card:hover::before {
            left: 100%;
        }
        
        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.12);
        }
        
        .stat-card.bookings {
            --card-color: #28a745;
        }
        
        .stat-card.excuses {
            --card-color: #ffc107;
        }
        
        .stat-card.available {
            --card-color: #17a2b8;
        }
        
        .stat-card.occupancy {
            --card-color: #6f42c1;
        }
        
        .stat-icon {
            width: 70px;
            height: 70px;
            margin: 0 auto 20px;
            background: var(--card-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .stat-number {
            font-size: 42px;
            font-weight: bold;
            color: var(--card-color);
            margin-bottom: 10px;
            line-height: 1;
        }
        
        .stat-label {
            font-size: 16px;
            color: #666;
            font-weight: 500;
            margin-bottom: 5px;
        }
        
        .stat-description {
            font-size: 13px;
            color: #999;
            line-height: 1.4;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 30px;
            align-items: start;
        }
        
        .controls-panel {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            position: sticky;
            top: 20px;
        }
        
        .controls-title {
            font-size: 20px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .control-btn {
            width: 100%;
            padding: 15px 20px;
            border: none;
            border-radius: 12px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 12px;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .control-btn:last-child {
            margin-bottom: 0;
        }
        
        .control-btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: all 0.4s ease;
        }
        
        .control-btn:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
            color: #000;
            box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
            box-shadow: 0 4px 15px rgba(220, 53, 69, 0.3);
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }
        
        .days-overview {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
        }
        
        .overview-title {
            font-size: 24px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 25px;
            text-align: center;
            padding-bottom: 15px;
            border-bottom: 3px solid #0d5c0d;
        }
        
        .days-grid {
            display: grid;
            gap: 20px;
        }
        
        .day-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .day-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #0d5c0d, #28a745);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }
        
        .day-card:hover::before {
            transform: scaleX(1);
        }
        
        .day-card:hover {
            border-color: #0d5c0d;
            background: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .day-info h3 {
            font-size: 20px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .day-info .date {
            font-size: 14px;
            color: #666;
        }
        
        .day-stats {
            text-align: center;
        }
        
        .stats-number {
            font-size: 24px;
            font-weight: bold;
            color: #0d5c0d;
            margin-bottom: 5px;
        }
        
        .stats-label {
            font-size: 12px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .progress-section {
            margin: 20px 0;
        }
        
        .progress-bar {
            width: 100%;
            height: 12px;
            background: #e9ecef;
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745, #20c997);
            border-radius: 6px;
            transition: width 1s ease;
            position: relative;
        }
        
        .progress-fill.full {
            background: linear-gradient(90deg, #dc3545, #c82333);
        }
        
        .progress-fill.warning {
            background: linear-gradient(90deg, #ffc107, #e0a800);
        }
        
        .progress-text {
            font-size: 13px;
            color: #666;
            text-align: center;
        }
        
        .bookings-preview {
            max-height: 150px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 10px;
            background: white;
        }
        
        .booking-item {
            padding: 8px 12px;
            margin-bottom: 6px;
            background: #f8f9fa;
            border-radius: 6px;
            font-size: 13px;
            border-left: 3px solid #28a745;
        }
        
        .booking-item:last-child {
            margin-bottom: 0;
        }
        
        .student-name {
            font-weight: 600;
            color: #0d5c0d;
            margin-bottom: 2px;
        }
        
        .parent-name {
            color: #666;
            font-size: 12px;
        }
        
        .empty-day {
            text-align: center;
            color: #999;
            font-style: italic;
            padding: 30px 20px;
            background: white;
            border: 2px dashed #e9ecef;
            border-radius: 8px;
        }
        
        .quick-stats {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }
        
        .quick-stats-title {
            font-size: 18px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .quick-stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }
        
        .quick-stat-item {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }
        
        .quick-stat-number {
            font-size: 20px;
            font-weight: bold;
            color: #0d5c0d;
            margin-bottom: 5px;
        }
        
        .quick-stat-label {
            font-size: 12px;
            color: #666;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .controls-panel {
                position: static;
                order: -1;
            }
            
            .control-btn {
                display: inline-flex;
                width: auto;
                margin: 5px;
                padding: 12px 20px;
            }
            
            .controls-title {
                margin-bottom: 15px;
            }
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                padding: 10px;
            }
            
            .admin-title {
                font-size: 24px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .stat-card {
                padding: 20px 15px;
            }
            
            .stat-number {
                font-size: 32px;
            }
            
            .stat-icon {
                width: 60px;
                height: 60px;
                font-size: 24px;
            }
        }
        
        @media (max-width: 480px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #0d5c0d;
        }
        
        .modal-title {
            font-size: 28px;
            color: #0d5c0d;
            font-weight: bold;
        }
        
        .close-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: #dc3545;
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .close-btn:hover {
            background: #c82333;
            transform: scale(1.1);
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .report-table th,
        .report-table td {
            padding: 12px 15px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        .report-table th {
            background: linear-gradient(135deg, #0d5c0d, #2d8f2d);
            color: white;
            font-weight: bold;
        }
        
        .report-table tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .report-table tr:hover {
            background: #e9ecef;
        }
        
        .summary-section {
            background: #e9ecef;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        .summary-title {
            font-size: 20px;
            color: #0d5c0d;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }
        
        .summary-item {
            text-align: center;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .summary-number {
            font-size: 24px;
            font-weight: bold;
            color: #0d5c0d;
            margin-bottom: 5px;
        }
        
        .summary-label {
            font-size: 14px;
            color: #666;
        }
        
        @media (max-width: 768px) {
            .dashboard-container {
                margin: 10px;
                padding: 0 10px;
            }
            
            .admin-title {
                font-size: 28px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .control-buttons {
                grid-template-columns: 1fr;
            }
            
            .days-overview {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                height: 95%;
                max-width: none;
                max-height: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <h1 class="admin-title">🎯 لوحة إدارة اجتماع أولياء الأمور</h1>
            <p class="admin-subtitle">متوسطة المنذر بن عمرو الأنصاري - مكتب تعليم العوالي</p>
            <div class="admin-info">👨‍💼 مدير المدرسة: خالد سعود المطيري</div>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">👥</div>
                <div class="stat-number" id="totalBookings">0</div>
                <div class="stat-label">إجمالي الحجوزات</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">😔</div>
                <div class="stat-number" id="totalExcuses">0</div>
                <div class="stat-label">إجمالي الاعتذارات</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">⭐</div>
                <div class="stat-number" id="availableSlots">400</div>
                <div class="stat-label">المقاعد المتاحة</div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">📊</div>
                <div class="stat-number" id="occupancyRate">0%</div>
                <div class="stat-label">نسبة الإشغال</div>
            </div>
        </div>
        
        <!-- Control Panel -->
        <div class="controls-section">
            <h2 class="controls-title">🛠️ أدوات الإدارة</h2>
            <div class="control-buttons">
                <button class="control-btn btn-primary" onclick="showDetailedReport()">
                    📋 تقرير مفصل
                </button>
                <button class="control-btn btn-secondary" onclick="exportToExcel()">
                    📤 تصدير Excel
                </button>
                <button class="control-btn btn-warning" onclick="printReport()">
                    🖨️ طباعة التقرير
                </button>
                <button class="control-btn btn-danger" onclick="resetAllData()">
                    🗑️ إعادة تعيين
                </button>
            </div>
        </div>
        
        <!-- Days Overview -->
        <div class="days-overview" id="daysOverview">
            <!-- سيتم إنشاؤها ديناميكياً بواسطة JavaScript -->
        </div>
    </div>
    
    <!-- Modal for Detailed Report -->
    <div class="modal" id="reportModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <div class="modal-header">
                <h2 class="modal-title">📊 التقرير المفصل</h2>
            </div>
            <div id="modalContent">
                <!-- سيتم إدراج محتوى التقرير هنا -->
            </div>
        </div>
    </div>
    
    <script>
        // بيانات الأيام
        const DAYS_DATA = {
            sunday: { name: 'الأحد', date: '15/3/1447هـ', max: 80 },
            monday: { name: 'الاثنين', date: '16/3/1447هـ', max: 80 },
            tuesday: { name: 'الثلاثاء', date: '17/3/1447هـ', max: 80 },
            wednesday: { name: 'الأربعاء', date: '18/3/1447هـ', max: 80 },
            thursday: { name: 'الخميس', date: '19/3/1447هـ', max: 80 }
        };
        
        // استرجاع البيانات
        let bookingsData = JSON.parse(localStorage.getItem('parentMeetingBookings') || '{}');
        
        // تحديث الإحصائيات
        function updateStatistics() {
            let totalBookings = 0;
            let totalCapacity = 0;
            let totalExcuses = 0;
            let busyDays = 0;
            let fullDays = 0;
            
            for (const dayKey in DAYS_DATA) {
                const dayBookings = bookingsData[dayKey] || [];
                totalBookings += dayBookings.length;
                totalCapacity += DAYS_DATA[dayKey].max;
                
                if (dayBookings.length > 0) busyDays++;
                if (dayBookings.length >= DAYS_DATA[dayKey].max) fullDays++;
            }
            
            // حساب الاعتذارات
            totalExcuses = bookingsData.excuses ? bookingsData.excuses.length : 0;
            
            const availableSlots = totalCapacity - totalBookings;
            const occupancyRate = totalCapacity > 0 ? Math.round((totalBookings / totalCapacity) * 100) : 0;
            const avgPerDay = Math.round(totalBookings / Object.keys(DAYS_DATA).length);
            const totalResponses = totalBookings + totalExcuses;
            const responseRate = totalResponses > 0 ? Math.round((totalResponses / (totalResponses + availableSlots)) * 100) : 0;
            
            // تحديث البطاقات الرئيسية
            document.getElementById('totalBookings').textContent = totalBookings;
            document.getElementById('totalExcuses').textContent = totalExcuses;
            document.getElementById('availableSlots').textContent = availableSlots;
            document.getElementById('occupancyRate').textContent = occupancyRate + '%';
            
            // تحديث الإحصائيات السريعة
            document.getElementById('busyDays').textContent = busyDays;
            document.getElementById('fullDays').textContent = fullDays;
            document.getElementById('avgPerDay').textContent = avgPerDay;
            document.getElementById('responseRate').textContent = responseRate + '%';
            
            // تحديث وقت آخر تحديث
            document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('ar-SA', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
        }
        
        // إنشاء عرض الأيام
        function createDaysOverview() {
            const container = document.getElementById('daysGrid');
            container.innerHTML = '';
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                const bookedCount = bookings.length;
                const availableCount = dayInfo.max - bookedCount;
                const progressPercent = Math.round((bookedCount / dayInfo.max) * 100);
                
                const dayCard = document.createElement('div');
                dayCard.className = 'day-card';
                
                let progressClass = '';
                if (progressPercent >= 100) progressClass = 'full';
                else if (progressPercent >= 80) progressClass = 'warning';
                
                dayCard.innerHTML = `
                    <div class="day-header">
                        <div class="day-info">
                            <h3>${dayInfo.name}</h3>
                            <div class="date">${dayInfo.date}</div>
                        </div>
                        <div class="day-stats">
                            <div class="stats-number">${bookedCount}/${dayInfo.max}</div>
                            <div class="stats-label">محجوز</div>
                        </div>
                    </div>
                    
                    <div class="progress-section">
                        <div class="progress-bar">
                            <div class="progress-fill ${progressClass}" style="width: ${progressPercent}%"></div>
                        </div>
                        <div class="progress-text">${availableCount} مقعد متاح</div>
                    </div>
                    
                    <div class="bookings-preview">
                        ${bookings.length > 0 ? 
                            bookings.slice(0, 4).map((booking, index) => `
                                <div class="booking-item">
                                    <div>
                                        <div class="student-name">${index + 1}. ${booking.studentName}</div>
                                        <div class="parent-name">👨‍💼 ${booking.parentName}</div>
                                    </div>
                                </div>
                            `).join('') + 
                            (bookings.length > 4 ? `<div style="text-align: center; color: #666; font-size: 12px; margin-top: 10px;">و ${bookings.length - 4} آخرين...</div>` : '')
                            :
                            '<div class="empty-day">لا توجد حجوزات</div>'
                        }
                    </div>
                `;
                
                container.appendChild(dayCard);
            }
        }
        
        // عرض التقرير المفصل
        function showDetailedReport() {
            const totalExcuses = bookingsData.excuses ? bookingsData.excuses.length : 0;
            
            let reportHTML = `
                <div class="summary-section">
                    <h3 class="summary-title">📈 ملخص الإحصائيات</h3>
                    <div class="summary-stats">
                        <div class="summary-item">
                            <div class="summary-number">${getTotalBookings()}</div>
                            <div class="summary-label">إجمالي الحجوزات</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${totalExcuses}</div>
                            <div class="summary-label">إجمالي الاعتذارات</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${getTotalAvailable()}</div>
                            <div class="summary-label">المقاعد المتاحة</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number">${getOccupancyRate()}%</div>
                            <div class="summary-label">نسبة الإشغال</div>
                        </div>
                    </div>
                </div>
            `;
            
            reportHTML += `
                <table class="report-table">
                    <thead>
                        <tr>
                            <th>اليوم</th>
                            <th>التاريخ</th>
                            <th>عدد الحجوزات</th>
                            <th>المقاعد المتاحة</th>
                            <th>نسبة الإشغال</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                const bookedCount = bookings.length;
                const availableCount = dayInfo.max - bookedCount;
                const dayOccupancy = Math.round((bookedCount / dayInfo.max) * 100);
                
                reportHTML += `
                    <tr>
                        <td><strong>${dayInfo.name}</strong></td>
                        <td>${dayInfo.date}</td>
                        <td>${bookedCount}/${dayInfo.max}</td>
                        <td>${availableCount}</td>
                        <td style="color: ${dayOccupancy >= 100 ? '#dc3545' : '#28a745'}">${dayOccupancy}%</td>
                    </tr>
                `;
            }
            
            reportHTML += '</tbody></table>';
            
            // إضافة قسم الاعتذارات
            if (totalExcuses > 0) {
                reportHTML += `
                    <div style="margin: 30px 0; padding: 25px; background: #fff3cd; border-radius: 15px; border: 2px solid #ffc107;">
                        <h3 style="color: #856404; margin-bottom: 20px; text-align: center;">
                            😔 الاعتذارات (${totalExcuses})
                        </h3>
                        <table class="report-table" style="font-size: 14px;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #ffc107, #e0a800); color: #000;">
                                    <th>#</th>
                                    <th>اسم الطالب</th>
                                    <th>اسم ولي الأمر</th>
                                    <th>رقم الجوال</th>
                                    <th>سبب الاعتذار</th>
                                    <th>وقت التسجيل</th>
                                </tr>
                            </thead>
                            <tbody>
                `;
                
                bookingsData.excuses.forEach((excuse, index) => {
                    reportHTML += `
                        <tr style="background: ${index % 2 === 0 ? '#fff3cd' : 'white'};">
                            <td>${index + 1}</td>
                            <td><strong>${excuse.studentName}</strong></td>
                            <td>${excuse.parentName}</td>
                            <td style="direction: ltr;">${excuse.phoneNumber}</td>
                            <td style="max-width: 200px; word-wrap: break-word; font-size: 13px;">${excuse.excuseReason}</td>
                            <td style="font-size: 12px;">${excuse.timestamp}</td>
                        </tr>
                    `;
                });
                
                reportHTML += '</tbody></table></div>';
            }
            
            // إضافة تفاصيل الحجوزات لكل يوم
            reportHTML += '<h3 style="margin-top: 30px; color: #0d5c0d;">📋 تفاصيل الحجوزات</h3>';
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                reportHTML += `
                    <div style="margin: 20px 0; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <h4 style="color: #0d5c0d; margin-bottom: 15px;">
                            ${dayInfo.name} - ${dayInfo.date} (${bookings.length}/${dayInfo.max})
                        </h4>
                `;
                
                if (bookings.length > 0) {
                    reportHTML += `
                        <table class="report-table" style="font-size: 14px;">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>اسم الطالب</th>
                                    <th>اسم ولي الأمر</th>
                                    <th>رقم الجوال</th>
                                    <th>وقت التسجيل</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    bookings.forEach((booking, index) => {
                        reportHTML += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${booking.studentName}</td>
                                <td>${booking.parentName}</td>
                                <td style="direction: ltr;">${booking.phoneNumber}</td>
                                <td style="font-size: 12px;">${booking.timestamp}</td>
                            </tr>
                        `;
                    });
                    
                    reportHTML += '</tbody></table>';
                } else {
                    reportHTML += '<p style="text-align: center; color: #999; font-style: italic;">لا توجد حجوزات لهذا اليوم</p>';
                }
                
                reportHTML += '</div>';
            }
            
            document.getElementById('modalContent').innerHTML = reportHTML;
            document.getElementById('reportModal').style.display = 'block';
        }
        
        // إغلاق النافذة المنبثقة
        function closeModal() {
            document.getElementById('reportModal').style.display = 'none';
        }
        
        // تصدير إلى Excel
        function exportToExcel() {
            let csvContent = "نوع البيان,اليوم,التاريخ,اسم الطالب,اسم ولي الأمر,رقم الجوال,سبب الاعتذار,وقت التسجيل\n";
            
            // إضافة الحجوزات
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                bookings.forEach(booking => {
                    csvContent += `"حجز","${dayInfo.name}","${dayInfo.date}","${booking.studentName}","${booking.parentName}","${booking.phoneNumber}","","${booking.timestamp}"\n`;
                });
            }
            
            // إضافة الاعتذارات
            if (bookingsData.excuses && bookingsData.excuses.length > 0) {
                bookingsData.excuses.forEach(excuse => {
                    csvContent += `"اعتذار","","","${excuse.studentName}","${excuse.parentName}","${excuse.phoneNumber}","${excuse.excuseReason}","${excuse.timestamp}"\n`;
                });
            }
            
            const blob = new Blob(["\ufeff" + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `اجتماع_أولياء_الأمور_شامل_${new Date().toLocaleDateString('ar-SA')}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // طباعة التقرير
        function printReport() {
            const printWindow = window.open('', '_blank');
            const printContent = generatePrintContent();
            
            printWindow.document.write(printContent);
            printWindow.document.close();
            printWindow.focus();
            setTimeout(() => printWindow.print(), 500);
        }
        
        // إنشاء محتوى الطباعة
        function generatePrintContent() {
            return `
                <!DOCTYPE html>
                <html lang="ar" dir="rtl">
                <head>
                    <meta charset="UTF-8">
                    <title>تقرير اجتماع أولياء الأمور</title>
                    <style>
                        body { font-family: Arial; padding: 20px; direction: rtl; }
                        .header { text-align: center; margin-bottom: 30px; }
                        .title { color: #0d5c0d; font-size: 24px; font-weight: bold; }
                        .subtitle { color: #666; margin: 10px 0; }
                        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                        th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
                        th { background: #0d5c0d; color: white; }
                        tr:nth-child(even) { background: #f9f9f9; }
                        .summary { background: #f0f0f0; padding: 15px; margin: 20px 0; border-radius: 5px; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1 class="title">تقرير اجتماع أولياء الأمور</h1>
                        <p class="subtitle">متوسطة المنذر بن عمرو الأنصاري - مكتب تعليم العوالي</p>
                        <p class="subtitle">مدير المدرسة: خالد سعود المطيري</p>
                        <p>التاريخ: ${new Date().toLocaleDateString('ar-SA')}</p>
                    </div>
                    
                    <div class="summary">
                        <h3>ملخص الإحصائيات:</h3>
                        <p>إجمالي الحجوزات: ${getTotalBookings()}</p>
                        <p>إجمالي الاعتذارات: ${bookingsData.excuses ? bookingsData.excuses.length : 0}</p>
                        <p>إجمالي المقاعد: ${getTotalCapacity()}</p>
                        <p>المقاعد المتاحة: ${getTotalAvailable()}</p>
                        <p>نسبة الإشغال: ${getOccupancyRate()}%</p>
                    </div>
                    
                    ${generatePrintTable()}
                </body>
                </html>
            `;
        }
        
        // إنشاء جدول الطباعة
        function generatePrintTable() {
            let tableHTML = '';
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                if (bookings.length > 0) {
                    tableHTML += `
                        <h3 style="color: #0d5c0d; margin-top: 30px;">
                            ${dayInfo.name} - ${dayInfo.date} (${bookings.length}/${dayInfo.max})
                        </h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>اسم الطالب</th>
                                    <th>اسم ولي الأمر</th>
                                    <th>رقم الجوال</th>
                                    <th>وقت التسجيل</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    bookings.forEach((booking, index) => {
                        tableHTML += `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${booking.studentName}</td>
                                <td>${booking.parentName}</td>
                                <td>${booking.phoneNumber}</td>
                                <td style="font-size: 11px;">${booking.timestamp}</td>
                            </tr>
                        `;
                    });
                    
                    tableHTML += '</tbody></table>';
                } else {
                    tableHTML += `
                        <h3 style="color: #0d5c0d; margin-top: 30px;">
                            ${dayInfo.name} - ${dayInfo.date} (0/${dayInfo.max})
                        </h3>
                        <p style="text-align: center; color: #999; font-style: italic; padding: 20px; border: 1px dashed #ccc;">
                            لا توجد حجوزات لهذا اليوم
                        </p>
                    `;
                }
            }
            
            // إضافة الاعتذارات
            const excuses = bookingsData.excuses || [];
            if (excuses.length > 0) {
                tableHTML += `
                    <h3 style="color: #856404; margin-top: 40px; background: #fff3cd; padding: 10px; border-radius: 5px;">
                        😔 الاعتذارات (${excuses.length})
                    </h3>
                    <table style="border: 2px solid #ffc107;">
                        <thead>
                            <tr style="background: #ffc107; color: #000;">
                                <th>#</th>
                                <th>اسم الطالب</th>
                                <th>اسم ولي الأمر</th>
                                <th>رقم الجوال</th>
                                <th>سبب الاعتذار</th>
                                <th>وقت التسجيل</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                excuses.forEach((excuse, index) => {
                    tableHTML += `
                        <tr style="background: ${index % 2 === 0 ? '#fff3cd' : 'white'};">
                            <td>${index + 1}</td>
                            <td>${excuse.studentName}</td>
                            <td>${excuse.parentName}</td>
                            <td>${excuse.phoneNumber}</td>
                            <td style="font-size: 11px; max-width: 150px; word-wrap: break-word;">${excuse.excuseReason}</td>
                            <td style="font-size: 10px;">${excuse.timestamp}</td>
                        </tr>
                    `;
                });
                
                tableHTML += '</tbody></table>';
            }
            
            return tableHTML;
        }
        
        // إعادة تعيين جميع البيانات
        function resetAllData() {
            const confirmMessage = 'هل أنت متأكد من حذف جميع بيانات الحجوزات؟\n\nتحذير: لا يمكن التراجع عن هذا الإجراء!';
            
            if (confirm(confirmMessage)) {
                const doubleConfirm = 'تأكيد أخير: سيتم حذف جميع البيانات نهائياً.\n\nهل تريد المتابعة؟';
                
                if (confirm(doubleConfirm)) {
                    localStorage.removeItem('parentMeetingBookings');
                    bookingsData = {};
                    updateStatistics();
                    createDaysOverview();
                    
                    alert('✅ تم حذف جميع البيانات بنجاح');
                }
            }
        }
        
        // دوال مساعدة للإحصائيات
        function getTotalBookings() {
            let total = 0;
            for (const dayKey in DAYS_DATA) {
                const bookings = bookingsData[dayKey] || [];
                total += bookings.length;
            }
            return total;
        }
        
        function getTotalCapacity() {
            let total = 0;
            for (const dayKey in DAYS_DATA) {
                total += DAYS_DATA[dayKey].max;
            }
            return total;
        }
        
        function getTotalAvailable() {
            return getTotalCapacity() - getTotalBookings();
        }
        
        function getOccupancyRate() {
            const total = getTotalBookings();
            const capacity = getTotalCapacity();
            return capacity > 0 ? Math.round((total / capacity) * 100) : 0;
        }
        
        // تحديث البيانات كل 30 ثانية (في حالة وجود حجوزات جديدة)
        function autoRefresh() {
            const newData = JSON.parse(localStorage.getItem('parentMeetingBookings') || '{}');
            
            // مقارنة البيانات الجديدة مع القديمة
            if (JSON.stringify(newData) !== JSON.stringify(bookingsData)) {
                bookingsData = newData;
                updateStatistics();
                createDaysOverview();
                
                // إظهار تنبيه للمدير
                showNotification('📬 تم استلام حجز جديد!');
            }
        }
        
        // إظهار إشعار للمدير
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #28a745, #20c997);
                color: white;
                padding: 15px 20px;
                border-radius: 10px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 9999;
                font-size: 16px;
                font-weight: bold;
                animation: slideIn 0.5s ease;
            `;
            
            notification.textContent = message;
            document.body.appendChild(notification);
            
            // إزالة الإشعار بعد 5 ثوانٍ
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.5s ease';
                setTimeout(() => document.body.removeChild(notification), 500);
            }, 5000);
        }
        
        // إضافة CSS للرسوم المتحركة
        const animationCSS = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        
        const styleSheet = document.createElement('style');
        styleSheet.textContent = animationCSS;
        document.head.appendChild(styleSheet);
        
        // إغلاق النافذة المنبثقة بالنقر خارجها
        document.getElementById('reportModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
        
        // معالج لوحة المفاتيح
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });
        
        // دالة البحث السريع (يمكن إضافتها لاحقاً)
        function searchBookings(query) {
            const results = [];
            
            for (const [dayKey, dayInfo] of Object.entries(DAYS_DATA)) {
                const bookings = bookingsData[dayKey] || [];
                
                bookings.forEach(booking => {
                    if (booking.studentName.includes(query) || 
                        booking.parentName.includes(query) || 
                        booking.phoneNumber.includes(query)) {
                        results.push({
                            ...booking,
                            day: dayInfo.name,
                            date: dayInfo.date
                        });
                    }
                });
            }
            
            return results;
        }
        
        // إنشاء تقرير يومي
        function generateDailyReport(dayKey) {
            const dayInfo = DAYS_DATA[dayKey];
            const bookings = bookingsData[dayKey] || [];
            
            return {
                day: dayInfo.name,
                date: dayInfo.date,
                totalBookings: bookings.length,
                maxCapacity: dayInfo.max,
                availableSlots: dayInfo.max - bookings.length,
                occupancyRate: Math.round((bookings.length / dayInfo.max) * 100),
                bookings: bookings
            };
        }
        
        // تصدير تقرير يوم واحد
        function exportDayReport(dayKey) {
            const report = generateDailyReport(dayKey);
            const dayInfo = DAYS_DATA[dayKey];
            
            let csvContent = `تقرير ${dayInfo.name} - ${dayInfo.date}\n`;
            csvContent += `إجمالي الحجوزات: ${report.totalBookings}\n`;
            csvContent += `المقاعد المتاحة: ${report.availableSlots}\n`;
            csvContent += `نسبة الإشغال: ${report.occupancyRate}%\n\n`;
            csvContent += "الرقم,اسم الطالب,اسم ولي الأمر,رقم الجوال,وقت التسجيل\n";
            
            report.bookings.forEach((booking, index) => {
                csvContent += `"${index + 1}","${booking.studentName}","${booking.parentName}","${booking.phoneNumber}","${booking.timestamp}"\n`;
            });
            
            const blob = new Blob(["\ufeff" + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', `${dayInfo.name}_${dayInfo.date}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        // تشغيل لوحة الإدارة
        document.addEventListener('DOMContentLoaded', function() {
            updateStatistics();
            createDaysOverview();
            
            // تحديث التاريخ الحالي
            const now = new Date();
            document.getElementById('currentDate').textContent = 
                `📅 ${now.toLocaleDateString('ar-SA', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                })}`;
            
            // تحديث تلقائي كل 30 ثانية
            setInterval(autoRefresh, 30000);
            
            // إضافة تأثيرات بصرية للبطاقات
            const statCards = document.querySelectorAll('.stat-card');
            statCards.forEach((card, index) => {
                setTimeout(() => {
                    card.style.opacity = '0';
                    card.style.transform = 'translateY(30px)';
                    card.style.transition = 'all 0.6s ease';
                    
                    setTimeout(() => {
                        card.style.opacity = '1';
                        card.style.transform = 'translateY(0)';
                    }, 100);
                }, index * 150);
            });
            
            // تحديث مؤشر الوقت كل ثانية
            setInterval(() => {
                document.getElementById('lastUpdate').textContent = 
                    new Date().toLocaleTimeString('ar-SA', {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit'
                    });
            }, 1000);
        });
        
        // إضافة رسوم متحركة للبطاقات
        const cardAnimationCSS = `
            @keyframes slideInUp {
                from {
                    opacity: 0;
                    transform: translateY(30px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        `;
        
        const cardStyleSheet = document.createElement('style');
        cardStyleSheet.textContent = cardAnimationCSS;
        document.head.appendChild(cardStyleSheet);
        
        // معالج التحديث المباشر
        window.addEventListener('storage', function(e) {
            if (e.key === 'parentMeetingBookings') {
                bookingsData = JSON.parse(e.newValue || '{}');
                updateStatistics();
                createDaysOverview();
                showNotification('🔄 تم تحديث البيانات تلقائياً');
            }
        });
    </script>
</body>
</html>
